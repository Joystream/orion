"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const db_1 = require("./util/db");
const server_1 = require("./util/server");
describe('check extension', function () {
    (0, db_1.useDatabase)([
        `create table account (id text primary key, balance integer)`
    ]);
    const client = (0, server_1.useServer)('lib/test/check-extension');
    it('can forbid with false', function () {
        return client.httpErrorTest(`
            query forbid {
                accounts { id balance }
            }
        `, {
            errors: [
                { message: 'not allowed' }
            ]
        });
    });
    it('can forbid with error message', function () {
        return client.httpErrorTest(`
            query complex {
                accounts { id balance }
            }
        `, {
            errors: [
                { message: 'too complex' }
            ]
        });
    });
    it('can allow with true', function () {
        return client.test(`
            query {
                accounts { id balance }
            }
        `, {
            accounts: []
        });
    });
});
//# sourceMappingURL=check.test.js.map