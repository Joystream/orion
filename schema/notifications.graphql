
type EmailDelivered @entity {
  "Autoincremented"
  id: ID!

  "the notification being delivered"
  notification: Notification!

  "when was this delivered according to server time"
  deliveryAttemptAt: DateTime!

  "delivery status"
  deliveryStatus: EmailDeliveryStatus!
}

enum EmailDeliveryStatus {
  Success
  Failure
}

# timestamp for in app delivery is not needed, since it is the same as the notification creation timestamp
type NotificationInAppDelivery @entity {
  "Autoincremented"
  id: ID!

  "the notification being delivered"
  notification: Notification!
}
type NotificationData {
  "text to display"
  text: String!

  "page link"
  linkPage: String!
}

type Read {
  "timestamp"
  readAt: DateTime!
}

type Unread {
  phantom: Int
}

union ReadOrUnread = Read | Unread

type Notification @entity {
  "
  id is computed as follows 
  - id = 'offchain' ++ '-' ++ 'offchainGlobalCounter' for offchain notifications 
  - id = 'onchain' ++ '-' ++ 'onchainGlobalCounter' for runtime related notifications 
  This will prevent conflicts during migration
  "
  id: ID!

  "Member that should recieve the notification"
  account: Account!

  "type of the notification, used for"
  notificationType: NotificationType!

  "related event for on chain notifications"
  event: Event!

  "status"
  status: ReadOrUnread!
}

union RecipientType = MemberRecipient | ChannelRecipient

type MemberRecipient {
  "member handle"
  memberHandle: String!
}

type ChannelRecipient {
  "channel title"
  channelTitle: String!
}

union NotificationType =
    YppSignupSuccessful
  | ChannelVerified
  | ChannelExcluded
  | VideoExcluded
  | NewChannelFollower
  | VideoFeaturedOnCategoryPage
  | VideoFeaturedAsCategoryHero
  | NftFeaturedOnMarketPlace
  | CommentPostedToVideo
  | VideoLiked
  | VideoDisliked
  | NftPurchased
  | CreatorReceivesAuctionBid
  | RoyaltyPaid
  | DirectChannelPaymentByMember
  | EnglishAuctionSettled
  | ChannelFundsWithdrawn
  | ChannelCreated
  | CommentReply
  | ReactionToComment
  | VideoPosted
  | NewAuction
  | NewNftOnSale
  | HigherBidPlaced
  | EnglishAuctionWon
  | EnglishAuctionLost
  | OpenAuctionWon
  | OpenAuctionLost

type YppSignupSuccessful @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: MemberRecipient!
}

type ChannelVerified @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: ChannelRecipient!
}

type ChannelExcluded @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: ChannelRecipient!
}

type VideoExcluded @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: ChannelRecipient!
}

type NewChannelFollower @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: ChannelRecipient!
}

type CommentPostedToVideo @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type VideoLiked @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type VideoDisliked @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type NftPurchased @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type CreatorReceivesAuctionBid @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type RoyaltyPaid @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type DirectChannelPaymentByMember @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type EnglishAuctionSettled @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type ChannelFundsWithdrawn @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type ChannelCreated @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type CommentReply @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type ReactionToComment @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type VideoPosted @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type NewAuction @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type NewNftOnSale @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type HigherBidPlaced @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type EnglishAuctionWon @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type EnglishAuctionLost @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type OpenAuctionWon @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}

type OpenAuctionLost @variant {
  "notification data"
  data: NotificationData!

  "recipient"
  recipient: RecipientType!
}